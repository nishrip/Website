<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Landing Page with Fixed Canvas</title>
<style>
*, *::before, *::after { box-sizing: border-box; }

html, body { margin:0; padding:0; background:#000; font-family:Segoe UI, sans-serif; overflow-x:hidden; }

/* Canvas */
canvas#sequence {
  position: fixed;
  left: 0;
  width: 100vw;
  z-index:0;
  background:black;
  object-fit:cover;
}

/* Navigation */
nav {
  position: fixed;
  top:0; left:0;
  width:100%;
  background:rgb(49,49,49);
  box-shadow:0 4px 8px rgba(0,0,0,0.2),0 6px 20px rgba(0,0,0,0.19);
  padding:1rem;
  display:flex; justify-content:space-between; align-items:center;
  z-index:10;
}

nav .logo a { color:white; text-decoration:none; font-weight:bold; font-size:1.5rem; text-shadow:0 0 3px rgba(8,0,0,0.47);}
nav .nav-links { display:flex; gap:2rem; flex-wrap:wrap; }
nav .nav-links a { color:white; text-decoration:none; font-weight:bold; user-select:none; text-shadow:0 0 3px rgba(8,0,0,0.47); transition:transform 0.2s, color 0.2s; }
nav .nav-links a:hover { color:#d33a57; transform:scale(1.1); }
nav .nav-links a:active { transform:scale(1); }

nav .hamburger { display:none; flex-direction:column; cursor:pointer; gap:5px; z-index:11; }
nav .hamburger div { width:25px; height:3px; background:white; border-radius:2px; transition: background 0.2s, transform 0.2s;}
nav .hamburger:hover div { background:#d33a57; } 
nav .hamburger:active div { background:#a22a45; }

@media(max-width:700px){
  nav .hamburger { display:flex; }
  nav .nav-links {
    position:absolute; top:100%; left:0; width:100%; flex-direction:column; background:rgb(106,106,106);
    padding:0; gap:0; opacity:0; pointer-events:none; transform:translateY(-10px);
    transition:opacity 0.36s cubic-bezier(.22,.8,.2,1), transform 0.36s cubic-bezier(.22,.8,.2,1);
  }
  nav .nav-links.show { opacity:1; transform:translateY(0); pointer-events:auto; }
  nav .nav-links a { display:block; width:100%; text-align:center; padding:0.75rem 0; background:none; transition:background 0.2s; }
  nav .nav-links a:hover { background:#d33a57; color:white; }
  nav .nav-links a:active { background:#a22a45; }
}

/* Sections */
section { position:relative; margin:50% auto; padding:6rem 1rem; width:90%; max-width:900px; background:rgba(0,0,0,0.84); border-radius:20px; box-shadow:0 8px 25px rgba(0,0,0,0.4); z-index:1;}
section .mask { position:relative; overflow:hidden; max-height:calc(100vh - 100px); margin:0 auto;}
section .content { max-width:900px; margin:0 auto; padding:2rem 3rem; color:#fff; text-align:center;}
@media(max-width:480px){ section { padding:4rem 1rem; width:95%; border-radius:16px; } section .content { padding:1.5rem 1rem; } }
</style>
</head>
<body>

<nav>
  <div class="logo"><a href="index.html">PREISE</a></div>
  <div class="nav-links" id="navLinks">
    <a href="portfolio.html">PORTFOLIO</a>
    <a href="#">PREISE</a>
    <a href="#">CLIENTS</a>
    <a href="#">KONTAKT</a>
  </div>
  <div class="hamburger" id="hamburger"><div></div><div></div><div></div></div>
</nav>

<canvas id="sequence"></canvas>

<section id="section1"><div class="mask"><div class="content"><h2>About Me</h2><p>Lorem ipsum dolor sit amet...</p></div></div></section>
<section id="section2"><div class="mask"><div class="content"><h2>Skills & Services</h2><p>More text for testing scroll behavior.</p></div></div></section>
<section id="section3"><div class="mask"><div class="content"><h2>Contact</h2><p>Placeholder for contact details.</p></div></div></section>

<script>
const canvas = document.getElementById("sequence");
const ctx = canvas.getContext("2d");
const frameCount = 120;
const images = [];
let currentFrame=0, targetFrame=0;

// Check mobile
const isMobile = window.innerWidth<700;
const revealBuffer = 50;

function updateCanvas(){
  const viewportHeight = window.innerHeight;
  if(isMobile){
    const navTop = document.querySelector('nav').getBoundingClientRect().top;
    canvas.width = window.innerWidth;
    canvas.height = viewportHeight + revealBuffer;
    canvas.style.top = navTop + 'px';
  }else{
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    canvas.style.top = '0px';
  }
}
updateCanvas();

const getFramePath = i=>`frames3/${i.toString().padStart(4,'0')}.jpg`;

function drawImage(img){
  const scale = Math.max(canvas.width/img.width, canvas.height/img.height);
  const x = (canvas.width/2)-(img.width/2)*scale;
  const y = 0;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.drawImage(img,x,y,img.width*scale,img.height*scale);
}

function loadFrame(i){
  if(i<0||i>=frameCount)return;
  if(!images[i]){
    const img = new Image();
    img.src = getFramePath(i);
    img.onload = ()=>{ if(i===currentFrame) drawImage(img); };
    images[i]=img;
  }
  return images[i];
}

function preloadNearby(center, range=20){
  for(let o=-range;o<=range;o++) loadFrame(center+o);
}

loadFrame(0);
preloadNearby(0,20);

window.addEventListener('scroll', ()=>{
  const scrollTop = window.scrollY;
  const scrollHeight = document.body.scrollHeight-window.innerHeight;
  const fraction = scrollTop/scrollHeight;
  targetFrame = Math.min(frameCount-1, Math.floor(fraction*frameCount));
});

function animate(){
  if(currentFrame!==targetFrame){
    currentFrame += (targetFrame>currentFrame?1:-1);
    const img=loadFrame(currentFrame);
    if(img?.complete) drawImage(img);
    preloadNearby(currentFrame,20);
  }
  requestAnimationFrame(animate);
}
animate();

window.addEventListener('resize', updateCanvas);
window.addEventListener('orientationchange', updateCanvas);

document.getElementById("hamburger").addEventListener('click', ()=>document.getElementById("navLinks").classList.toggle("show"));
</script>

</body>
</html>
