<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Landing Page with Fixed Canvas</title>
<link rel="stylesheet" href="global.css">
<style>
/* Sections */
section {
  position: relative;
  margin: 50% auto;
  padding: 6rem 1rem;
  width: 90%;
  max-width: 900px;
  background: rgba(0, 0, 0, 0.84);
  border-radius: 20px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.4);
  z-index: 1;
}

/* Mask container */
section .mask {
  position: relative;
  overflow: hidden;
  max-height: calc(100vh - 100px);
  margin: 0 auto;
}

/* Content */
section .content {
  max-width: 900px;
  margin: 0 auto;
  padding: 2rem 3rem;
  color: #ffffff;
  text-align: center;
}

/* Responsive */
@media (max-width: 480px) {
  section {
    padding: 4rem 1rem;
    width: 95%;
    border-radius: 16px;
  }
  section .content {
    padding: 1.5rem 1rem;
  }
}

/* Canvas fixed top with extra height for reveal */
canvas#sequence {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;          /* full width */
  height: auto;          /* height auto to maintain aspect ratio */
  min-height: 120vh;     /* extra height for reveal below viewport */
  z-index: 0;
  background: black;
}
</style>
</head>
<body>

<!-- Navigation -->
<nav>
  <div class="logo"><a href="index.html">PREISE</a></div>
  <div class="nav-links" id="navLinks">
    <a href="portfolio.html">PORTFOLIO</a>
    <a href="#">PREISE</a>
    <a href="#">CLIENTS</a>
    <a href="#">KONTAKT</a>
  </div>
  <div class="hamburger" id="hamburger">
    <div></div><div></div><div></div>
  </div>
</nav>

<!-- Canvas -->
<canvas id="sequence"></canvas>

<!-- Sections -->
<section id="section1">
  <div class="mask">
    <div class="content">
      <h2>About Me</h2>
      <p>Lorem ipsum dolor sit amet...</p>
    </div>
  </div>
</section>

<section id="section2">
  <div class="mask">
    <div class="content">
      <h2>Skills & Services</h2>
      <p>More text for testing scroll behavior.</p>
    </div>
  </div>
</section>

<section id="section3">
  <div class="mask">
    <div class="content">
      <h2>Contact</h2>
      <p>Placeholder for contact details.</p>
    </div>
  </div>
</section>

<script>
const canvas = document.getElementById("sequence");
const ctx = canvas.getContext("2d");
const frameCount = 120;
const images = [];
let currentFrame = 0;
let targetFrame = 0;

// --- Initial Canvas dimensions ---
const deviceWidth = window.screen.width;
const deviceHeight = window.screen.height;
canvas.width = deviceWidth;
canvas.height = deviceHeight * 1.2; // 120% height for reveal

// Frame path generator
const getFramePath = i => `frames3/${i.toString().padStart(4,'0')}.jpg`;

// Draw image with cover scaling, top-aligned
function drawImageCover(img){
  const scale = deviceWidth / img.width;
  const x = 0; 
  const y = 0; // always top-aligned
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.drawImage(img, x, y, img.width * scale, img.height * scale);
}

// Load frame
function loadFrame(i){
  if(i<0 || i>=frameCount) return;
  if(!images[i]){
    const img = new Image();
    img.src = getFramePath(i);
    img.onload = ()=> { if(i===currentFrame) drawImageCover(img); };
    images[i] = img;
  }
  return images[i];
}

// Preload frames around current
function preloadNearbyFrames(center, range=20){
  for(let offset=-range; offset<=range; offset++){
    loadFrame(center+offset);
  }
}

loadFrame(0);
preloadNearbyFrames(0,20);

// Scroll handler
window.addEventListener("scroll", () => {
  const scrollTop = window.scrollY;
  const scrollHeight = document.body.scrollHeight - window.innerHeight;
  const scrollFraction = scrollTop / scrollHeight;
  targetFrame = Math.min(frameCount-1, Math.floor(scrollFraction*frameCount));
});

// Animation loop
function animateFrames(){
  if(currentFrame !== targetFrame){
    const dir = targetFrame > currentFrame ? 1 : -1;
    currentFrame += dir;
    const img = loadFrame(currentFrame);
    if(img?.complete) drawImageCover(img);
    preloadNearbyFrames(currentFrame,20);
  }
  requestAnimationFrame(animateFrames);
}
animateFrames();

// Hamburger menu
const hamburger = document.getElementById("hamburger");
const navLinks = document.getElementById("navLinks");
hamburger.addEventListener("click", ()=>navLinks.classList.toggle("show"));
</script>

</body>
</html>
